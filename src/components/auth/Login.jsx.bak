import React from 'react';
import axios from 'axios';
import { Link, useNavigate } from 'react-router-dom';
import { secureLocalStorage } from 'react-secure-storage';
import Home from '../main/home';

import headerfest from '../../assets/headerfest.gif';

const Login = () => {
  const navigate = useNavigate();
    const [form, setForm] = React.useState({ email: '', password: '' });
    const handleChange = (e) => {
        const { name, value } = e.target;
        setForm((prevForm) => ({ ...prevForm, [name]: value }));
      };
    const handleLogin = async (e) => {
        e.preventDefault();
       // setLoading(true);
        //setError(null);
        try {
          const response = await fetch('https://dummyjson.com/auth/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              username: form.email,
              password: form.password,
              expiresInMins: 60,
            })
          });
    
          if (!response.ok) {
            throw new Error('Login failed');
          }
    
          const data = await response.json();
          console.log(data.accessToken);
    
          if (data.accessToken) { // Check if login was successful by verifying token
            sessionStorage.setItem('token', data.accessToken)
            alert('Login successful');           
           navigate('/home');
        } else {
            alert('Login failed: No token received');
        }

        } catch (error) {
         // setError(error.message);
          alert(`Error: ${error.message}`);
        } 
      };

    return (
        <div className='flex flex-col min-h-screen'>      
          <div className='flex items-center justify-center grow shrink my-10'>
            <form className='sm:w-[400px] p-4 s2:p-10 border shadow-md rounded-md bg-white/20 text-left backdrop-blur-sm' onSubmit={handleLogin} >
              <div className='flex justify-center items-end'>
                <img src={headerfest} className='' alt="" style={{ width: '116px', height: '35px', borderRadius: '4px'}}/>
              </div>
              <div className='mt-[25px] w-full'>
                <p className='text-[14px]'>Email</p>
                <input type='text' name="email" className='h-[36px] rounded-md border w-full bg-white/30 text-left backdrop-blur-sm outline-[#e4459b] px-3' value={form.email} onChange={handleChange}/>
              </div>
              {/* <div className='mt-[25px] w-full'>
                <p className='text-[14px]'>Name</p>
                <input type='text' name="text" className='h-[36px] rounded-md border w-full bg-white/30 text-left backdrop-blur-sm outline-[#e4459b] px-3' value={form.text} onChange={handleChange}/>
              </div> */}
              <div className='mt-[25px] w-full'>
                <p className='text-[14px]'>Password</p>
                <input type='password' name="password" className='h-[36px] rounded-md border w-full bg-white/30 text-left backdrop-blur-sm outline-[#e4459b] px-3' value={form.password} onChange={handleChange}/>
              </div>
              <button className='text-center bg-[#e4459b] rounded-md h-[32px] shadow-md w-full mt-6 text-[13px] font-medium text-white hover:opacity-90 hover:transition-all outline-white/80'>
                 LOGIN
              </button>   
            </form>
          </div>
        </div>
      )
}

export default Login